<!DOCTYPE html>
<html lang="en">
<%- include header %>
<link href="/admin/<%= assets %>/img/wangEditor.css" rel="stylesheet">
<link href="/admin/<%= assets %>/img/simple-dateselector.css" rel="stylesheet">
<body>
    <div id="navigator">
        <div class="logo">
            <a href="/panel">
                <em class="nl1"></em>
                <em class="nl2"></em>
                <em class="nl3"></em>
                <i class="material-icons">slow_motion_video</i>
            </a>
        </div>
        <div class="navigator">
            <ul>
                <li>
                    <a href="/panel/system">
                        <em class="nl1"></em>
                        <em class="nl2"></em>
                        <em class="nl3"></em>
                        <i></i>
                        <span>系统</span>
                    </a>
                </li>
                <li class="cur">
                   <a href="/panel/contents">
                        <em class="nl1"></em>
                        <em class="nl2"></em>
                        <em class="nl3"></em>
                        <i></i>
                        <span>内容</span>
                   </a>
                </li>
                <li>
                   <a href="/panel/users">
                        <em class="nl1"></em>
                        <em class="nl2"></em>
                        <em class="nl3"></em>
                        <i></i>
                        <span>用户</span>
                   </a>
                </li>
                <li>
                   <a href="/panel/styles">
                        <em class="nl1"></em>
                        <em class="nl2"></em>
                        <em class="nl3"></em>
                        <i></i>
                        <span>样式</span>
                   </a>
                </li>
                <li>
                   <a href="/panel/extensions">
                        <em class="nl1"></em>
                        <em class="nl2"></em>
                        <em class="nl3"></em>
                        <i></i>
                        <span>拓展</span>
                   </a>
                </li>
            </ul>
        </div>
    </div>
    
<% include brand %>
    
    <div class="container">
        <div class="ct">
            <div class="contents_menu">
                <div class="contents_title"><a href="/panel/contents"><i class="material-icons">insert_drive_file</i><span>列表集</span></a></div><ul>
                    <li><a href="/panel/contents/media"><i class="material-icons">video_library</i><span>媒体库</span></a></li><li><a href="/panel/contents/model"><i class="material-icons">insert_drive_file</i><span>模型</span></a></li><li><a href="/panel/contents/categories"><i class="material-icons">menu</i><span>分类</span></a></li><li><a href="/panel/contents/comments"><i class="material-icons">comment</i><span>留言</span></a></li>
                </ul>
            </div>
            
            <div style="width:800px">
                <div class="infomation fl">
                    <div class="pd20">
                        编辑已发布内容 列表集<span class="blue"><%- infomations.guid %></span> 模型<span class="blue"><%- infomations.model %></span>
                    </div>
                </div>
                <div class="content_edit fr">
                    <div class="content_edit_remove red_btn">删除</div>
                </div>
                <div class="clear"></div>
            </div>
            
            <div class="post_new">
                <div class="model_editor metro">
                    <dl>
                        <dt><i class="material-icons">menu</i><span>分类</span></dt><dd>
                            <div class="pd15" data-s="name">
                                <div class="select_categories"></div>
                                <div class="select_categories_info"></div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                    <dl>
                        <dt><i class="material-icons">title</i><span>标题</span></dt><dd>
                            <div class="pd15" data-s="title">
                                <input class="insert" value="<%= infomations.contents.title %>" placeholder="网站标题" type="text" /><span class="red">*</span>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                    <dl>
                        <dt><i class="material-icons">access_time</i><span>时间</span></dt><dd>
                            <div class="pd15" data-s="date">
                                <div class="simpledateselector">
                                    <input class="insert" value="<%= infomations.contents.postdate %>" placeholder="发布时间" type="text" /><span class="red">*</span>
                                </div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                    <dl>
                        <dt><i class="material-icons">device_hub</i><span>路由</span></dt><dd>
                            <div class="pd15" data-s="router">
                                <input class="insert" value="<%= infomations.contents.router %>" placeholder="用作内容url，只能填写英文" type="text" />
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                    <% infomations.datas.forEach(function(d,i){ %>
                        <% if(d.type=='form'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="form">
                                <input class="insert" value="<%= infomations.contents['field_'+d.id] %>" placeholder="请填写<%= d.name %>" type="text" />
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='d-form'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="d-form">
                                <input class="insert d_value" value="<%= infomations.contents['field_'+d.id] %>" placeholder="请填写<%= d.name %>" type="text"><div class="form_unit"><span><%= d.value %></span></div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='media'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="media">
                                <div class="media_input small">
                                    <input class="insert" name="icon" type="text" placeholder="从媒体库中选择文件" value="<%= infomations.contents['field_'+d.id] %>" />
                                    <div class="media_input_btn"><i class="material-icons">subscriptions</i></div>
                                </div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='media-l'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="media-l">
                                <% var arr = infomations.contents['field_'+d.id] ? infomations.contents['field_'+d.id].split(',') : []; %>
                                <% arr.forEach(function(p){ %>
                                <div class="media_input small">
                                    <input class="insert" name="icon" type="text" placeholder="从媒体库中选择文件" value="<%= p %>" />
                                    <div class="media_input_btn"><i class="material-icons">subscriptions</i></div>
                                    <div class="remove_btn_d"><i class="material-icons">remove</i></div>
                                </div>
                                <% }); %>
                                <div class="media_options">
                                    <div class="media_add"><i class="material-icons">add</i><span>添加选项</span></div>
                                </div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='checkbox'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="checkbox">
                                <% var arr = d.value ? d.value.split(',') : []; %>
                                <% var valueArr = infomations.contents['field_'+d.id] ? infomations.contents['field_'+d.id].split(',') : []; %>
                                
                                
                                <%
                                var arIndex = '';
                                arr.forEach(function(p,i){
                                    if(!p){
                                        return ;
                                    }
                                    
                                    if(valueArr[i]*1==1) arIndex = i;
                                });
                                %>
                                
                                
                                
                                <h4><i class="material-icons">radio_button_checked</i><span>单选</span>
                            <% if(d.filter){ %>
                                <span class="green">该字段检索为"fd<%= d.id %>-<em><%= arIndex %></em>"</span> (只有在同一分类下的模型类型都相同时,才能使用筛选)
                            <% } %>
                                </h4>
                                <div>
                                <% arr.forEach(function(p,i){ %>
                                    <% if(!p){ return ; } %>
                                    <div class="form_check"><i<%= (valueArr[i]*1==1) ? ' class=sl' : '' %>><b></b></i><span><%= p %></span></div>
                                <% }) %>
                                </div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='options'){ %>
                   <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="options">
                                <h4><i class="material-icons">check_box</i><span>多选</span></h4>
                                <% var arr = d.value.split(','); %>
                                <% var valueArr = infomations.contents['field_'+d.id] ? infomations.contents['field_'+d.id].split(',') : [] ; %>
                                <% arr.forEach(function(p,i){ %>
                                    <% if(!p){ return ; } %>
                                    <div class="form_check"><i<%= (valueArr[i]*1==1) ? ' class=sl' : '' %>><b></b></i><b></b></i><span><%= p %></span></div>
                                <% }) %>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        <% if(d.type=='content'){ %>
                    <dl class="custom_field" data-id="<%= d.id %>">
                        <dt><span><%= d.name %></span></dt><dd>
                            <div class="pd15 field_type" data-s="content">
                                <div class="wang_editor">
                                    <%- infomations.contents['field_'+d.id] %>
                                </div>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                        <% } %>
                        
                    <% }) %>

                    <dl>
                        <dt><span>关键字</span></dt><dd>
                            <div class="pd15" data-s="keywords">
                                <% var tags = infomations.contents.tags.split(','); %>
                                <ul><% tags.forEach(function(d){ if(!d){ return ; } %><li><span><%= d %></span><span class="li_close"><i class="material-icons">close</i></span></li><% }) %><input class="insert" type="text" placeholder="输入关键字" value="" /></ul>
                            </div>
                        </dd>
                        <div class="clear"></div>
                    </dl>
                </div>

                <div class="submit">
                    <span class="fr editpost_btn">更新</span>
                    <div class="clear"></div>
                </div>
            </div>
            
        </div>
    </div>
    
    <script>
        var categories = <%- infomations.categories %>;
        var guid = "<%- infomations.guid %>";
        var model = "<%- infomations.model %>";
        var category = "<%- infomations.contents.category %>";
        var id = "<%- infomations.id %>";
    </script>
    <%- include footer %>
    <script src="/lib/simple-dateselector.js"></script>
    <script src="/lib/wangEditor.js"></script>
    <script>
        $(function(){
            $('.wang_editor').each(function(){
                var rdmId = `editor${~~(Math.random() * 10000)}`;
                $(this).attr('id',rdmId);
                var editor = new wangEditor(rdmId);
                editor.create();
            });
        });
        
        var dateSelector = new simpleDateSelector($('.simpledateselector')[0]);
        dateSelector.init('pass');
    </script>
</body>
</html>